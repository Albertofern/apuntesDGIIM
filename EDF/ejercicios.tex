%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                                                             %%
%% Este fichero contiene ejercicios tipo con sus respectivas soluciones.       %%
%% Autor: Ignacio Aguilera Martos                                              %%
%% https://github.com/nacheteam                                                %%
%%                                                                             %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Desintegración radioactiva %%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Desintegración radioactiva}
\begin{ejer}
	Un reactor transforma plutonio 239 en uranio 238 que es relativamente estable para
	uso industrial. Después de 15 años se determina que 0.0043 por ciento de la cantidad
	inicial A 0 de plutonio se ha desintegrado. Determina la semivida (tiempo necesario
	para que la cantidad inicial de los átomos se reduzca a la mitad) de este isótopo si
	la rapidez de desintegración es proporcional a la cantidad restante.
\end{ejer}
\begin{sol}
	Se toma como ecuación diferencial para la desintegración radioactiva la $m'(t)=-\lambda \cdot m(t)$ siendo $m(t)$ la masa en cada instante t.  
	Sabemos que después de 15 años hay $0.9957 \cdot A_0$ de masa siendo $A_0$ la masa que había inicialmente.  
	Integrando la ecuación diferencial dada obtenemos que $m(t) = c\cdot e^{-\lambda \cdot t}$. Con esto procedemos a obtener la constante $\lambda$.  
	$0.9957\cdot A_0 = A_0\cdot e^{-\lambda \cdot 15}$ con lo que $0.9957 = e^{-\lambda \cdot 15}$ de donde sacamos $ln(0.9957) = -15\cdot \lambda$ y por lo tanto obtenemos como constante $\lambda = \frac{ln(0.9957)}{-15}$.  
	Para calcular el tiempo de semivida tenemos ahora que ver en qué instante t obtenemos la mitad de la cantidad inicial con la constante que hemos despejado.  
	$\frac{1}{2}\cdot A_0 = A_0\cdot e^{\frac{ln(0.9957)}{15}\cdot t} \rightarrow \frac{ln(\frac{1}{2})}{\frac{ln(0.9957)}{15}}=t \rightarrow t = \frac{15\cdot ln(\frac{1}{2})}{ln(0.9957)} = 2412.753$ años.  
	La solución es que el tiempo de semivida es de 2412.753 años.
\end{sol}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Poblaciones con ley de Malthus %%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Poblaciones}
\begin{ejer}
	La población de Malthusilandia (país cuyo crecimiento sigue la ley de Malthus) era de 20 millones en 1980 y se había duplicado en 1990. ¿Qué población tendrá en el año 2000?
\end{ejer}
\begin{sol}
	Para este tipo de problemas usamos la ecuación diferencial $m'(t) = \lambda \cdot m(t)$ de donde obtenemos integrando $m(t) = c\cdot e^{\lambda \cdot t}$.  
	Sabemos que en el instante t=0 la población es de 20 millones, por lo tanto $20M = c\cdot e^{\lambda \cdot 0} = c$. Por lo tanto c=20M.  
	Sabemos que la población 10 años después es de 40 millones, por lo tanto $m(10) = 40M \Rightarrow 40M = 20M \cdot e^{\lambda \cdot 10} \Rightarrow 2 = e^{\lambda \cdot 10} \Rightarrow \lambda = \frac{ln(2)}{10}$.  
	Si queremos saber que población habrá en el 2000, es decir, en t = 20 sólo tenemos que sustituir en la fórmula.  
	$m(20) = 20M\cdot e^{\frac{ln(2)}{10}\cdot 20} = 80M$.  
	La población en el año 2000 será de 80 millones.
\end{sol}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Ecuaciones de Bernoulli %%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Ecuaciones de Bernoulli}
\begin{ejer}
	Resuelve la siguiente ecuación de Bernoulli: $(t^2\cdot x^2-1)\cdot x' + 2\cdot t\cdot x^3=0$ haciendo $x=z^\alpha$
\end{ejer}
\begin{sol}
	Las ecuaciones de bernoulli son de la forma $x' = a(t)\cdot x^q + b(t)\cdot x$ y debemos aplicar el siguiente cambio de variable para resolverlas:  
	$\begin{cases}
	s=t \\
	y=x^{1-q}
	\end{cases}$  
	Ponemos la ecuación dada en forma normal:  
	$x' = \frac{-2\cdot t\cdot x^3}{t^2\cdot x^2-1} = \frac{-2\cdot t\cdot z^{3\cdot \alpha}}{t^2\cdot z^{2\cdot \alpha}-1} = -2+z^{3\cdot \alpha}\cdot (\frac{1}{t^2}\cdot z^{-2\cdot \alpha}-1) = -2\cdot \frac{1}{t}\cdot z^{\alpha} - 2\cdot t\cdot z^{3\cdot \alpha} = \frac{-2}{t}\cdot x -2\cdot t\cdot x^3$  
	Después del cambio sugerido por el enunciado hemos obtenido una ecuación de Bernoulli.  
	Después de este cambio para resolver la ecuación tenemos que hacer el cambio de variable propuesto inicialmente:  
	$\begin{cases}
	s = t \\
	y = x^{-2}
	\end{cases}$  
	De donde obtenemos $y' = -2\cdot \frac{1}{x^3}\cdot x' = \frac{4}{x^2}\cdot (\frac{1}{t}-t\cdot x^2) = \frac{4}{t}\cdot y - 4\cdot t$  
	Con lo que hemos obtenido una ecuación lineal.
\end{sol}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Curva ortogonal %%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Curva ortogonal}
\begin{ejer}
	Obtén la familia de curvas ortogonales a la familia de curvas:  
	$y^2 = 2\cdot x^2\cdot (1-c\cdot x)$ con $c\in \mathbb{R}$
\end{ejer}
\begin{sol}
	En primer lugar obtenemos la expresión de c:  
	$y^2 = 2\cdot x^2 \cdot (1-c\cdot x)\Rightarrow \frac{y^2}{2\cdot x^2} = 1-c\cdot x \Rightarrow c\cdot x = 1-\frac{y^2}{2\cdot x^2} \Rightarrow c = \frac{1}{x} - \frac{y^2}{2\cdot x^3}$  
	Obtenemos ahora la expresión de y' y sustituimos la expresión de c obtenida:  
	$2\cdot y\cdot y' = 4\cdot x - c\cdot 6\cdot x^2$  
	$y' = \frac{4\cdot x}{2\cdot y}-\frac{c\cdot 6\cdot x^2}{2\cdot y} = 2\cdot \frac{x}{y}-c\cdot 3\cdot \frac{x^2}{y} = 2\cdot \frac{x}{y}-(\frac{1}{x}-\frac{y^2}{2\cdot x^3})\cdot 3\cdot \frac{x^2}{y} = 2\cdot \frac{x}{y}-3\cdot \frac{x}{y} + \frac{3}{2}\cdot \frac{y}{x} = \frac{3}{2}\cdot \frac{y}{x} - \frac{x}{y}$  
	Para obtener la familia ortogonal tenemos que cambiarle el signo y hacer el inverso:  
	$y' = -\frac{2}{3}\cdot \frac{x}{y} + \frac{y}{x}$  
	Esta ecuación es una de tipo homogénea por lo que hacemos el cambio $u = \frac{y}{x} \Rightarrow y = u\cdot x\Rightarrow y' = u+x\cdot u'$  e igualamos las expresiones de y' obtenidas:  
	$\frac{-2}{3\cdot u} + u = u + x\cdot u'\Rightarrow u' = \frac{-2}{3\cdot u\cdot x} = \frac{-2}{3\cdot u}\cdot \frac{1}{x}$  
	Nos ha salido una ecuación de variables separadas que resolvemos:  
	$\frac{du}{dx} = \frac{-2}{3\cdot u}\cdot \frac{1}{x}\Rightarrow \frac{-3}{2}\cdot \int u\cdot du = \int \frac{1}{x}\cdot dx$  
	$-\frac{3}{2}\cdot \frac{u^2}{2} = ln|x| + c \Rightarrow u = \sqrt{-\frac{4}{3}\cdot(ln|x| + c)}$  
	Deshaciendo el cambio de variable:  
	$y = \sqrt{-\frac{4}{3}\cdot (ln|x| + c)}\cdot x$
\end{sol}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Ecuaciones lineales %%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Ecuaciones lineales}

\begin{ejer}
	Resuelve la siguiente ecuación lineal: $x'-t\cdot x = 3\cdot t$
\end{ejer}
\begin{sol}
	Ponemos la ecuación en forma normal $x' = t\cdot x + 3\cdot t$ y realizamos el cambio de variable correspondiente para resolver las ecuaciones lineales.  
	$\begin{cases}
	s = t \\
	y = l(t)\cdot x
	\end{cases}$  
	Derivamos el cambio de variable haciendo la derivada de y con respecto a s.  
	$\frac{dy}{ds} = l'(s)\cdot x(s) + l(s)\cdot x(s)' = l'(s)\cdot x(s) + l(s)\cdot (s\cdot x + 3\cdot s) = x\cdot [l'(s) + l(s)\cdot s] + l(s)\cdot 3\cdot s$  
	Imponemos que $l'(s) + s\cdot l(s) = 0 \Rightarrow l'(s) = -s\cdot l(s)$ y resolvemos esta ecuación diferencial para obtener l(s) como una ecuación de variables separadas.  
	$l(s) = e^{-\frac{1}{2}\cdot t^2}$  
	Con esto ya lo podemos sustituir en la ecuación de y(s) dada inicialmente y resolver el problema.  
	$y(s) = \int_{s_0}^{s}l(u)\cdot 3\cdot u\cdot du = \int_{s_0}^{s}e^{-\frac{1}{2}\cdot u^2}\cdot 3\cdot u\cdot du = -3\cdot \int_{s_0}^{s}e^{-\frac{1}{2}\cdot u^2}\cdot (-u)\cdot du = -3\cdot e^{\frac{1}{2}\cdot u^2} \Big|_{s_0}^{s} + c$  
	Deshacemos el cambio de variable que hicimos al principio:  
	$\begin{cases}
	t=s \\
	x = \frac{y}{l(t)}
	\end{cases}$
	
	Obtenemos la x:  
	$x = \frac{y(t)}{l(t)} = e^{\frac{1}{2}\cdot t^2}\cdot (-3\cdot e^{-\frac{1}{2}\cdot t^2}\Big|_{t_0}^{t} + c)$  
	Con lo que habríamos obtenido la solución del problema.
\end{sol}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Ecuaciones exactas %%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Ecuaciones exactas}

\begin{ejer}
	Resuelve la ecuación diferencial $sen(t\cdot x) + t\cdot x\cdot cos(t\cdot x) + t^2\cdot cos(t\cdot x)\cdot x'$  
\end{ejer}
\begin{sol}
	Este tipo de ecuaciones tienen la forma $P(t,x) + Q(t,x)\cdot x' = 0$.  
	Debemos comprobar que se da la condición de exactitud, es decir:  
	$\frac{\partial P(t,x)}{\partial x} = \frac{\partial Q(t,x)}{\partial t}$  
	Si esta condición se cumple y estamos en un dominio estrellado como es nuestro caso, entonces sabemos que existe la función solución U(t,x).  
	$\frac{\partial P(t,x)}{\partial x} = cos(t\cdot x)\cdot t + t\cdot cos(t\cdot x) - t^2\cdot x\cdot sen(t\cdot x)$  
	$\frac{\partial Q(t,x)}{\partial t} = 2\cdot t\cdot cos(t\cdot x) - t^2\cdot x\cdot sen(t\cdot x)$  
	Como podemos comprobar en este caso se cumple la condición de exactitud y estamos en un dominio estrellado por lo que sabemos que $\exists U(t,x)$ tal que $\frac{\partial U(t,x)}{\partial t} = P(t,x)$ y $\frac{\partial U(t,x)}{\partial x} = Q(t,x)$  
	Para obtener la función U(t,x) vamos a integrar la función P(t,x) con respecto a t.  
	$\int P(t,x)\cdot dt = \int sen(t\cdot x) + t\cdot x\cdot cos(t\cdot x)\cdot dt = \int sen(t\cdot x)\cdot dt + x\cdot \int t\cdot cos(t\cdot x)\cdot dt$  
	La primera integral la resolvemos de manera inmediata:  
	$\int sen(t\cdot x)\cdot dt = \frac{-cos(t\cdot x)}{x} + c$  
	La segunda la tenemos que resolver por partes:  
	$$
	\begin{cases}
	u = t \\
	dv = cos(t\cdot x)
	\end{cases}
	\begin{cases}
	du = 1 \\
	v = \frac{sen(t\cdot x)}{x}
	\end{cases}
	$$  
	Resolviendo con la fórmula de integración por partes:  
	$\int t\cdot cos(t\cdot x)\cdot dt = \frac{t\cdot sen(t\cdot x)}{x}-\int \frac{sen(t\cdot x)}{x}\cdot dt$  
	$\int \frac{sen(t\cdot x)}{x}\cdot dt = \frac{-cos(t\cdot x)}{x^2}$  
	$x\cdot \int t\cdot cos(t\cdot x)\cdot dt = t\cdot sen(t\cdot x) + \frac{cos(t\cdot x)}{x}$  
	Con lo que:  
	$\int P(t,x)\cdot dt = -\frac{cos(t\cdot x)}{x} + t\cdot sen(t\cdot x) + \frac{cos(t\cdot x)}{x} + c = t\cdot sen(t\cdot x) + c$  
	De donde obtenemos que $U(t,x) = t\cdot sen(t\cdot x) + c + \phi (x)$  
	Para obtener este factor en función de x que nos queda tenemos que derivar con respecto a x e igualarlo con Q(t,x) para sacarlo.  
	$\frac{\partial U(t,x)}{\partial x} = t^2\cdot cos(t\cdot x) + \phi '(x)$  
	De donde sacamos que $\phi '(x) = 0$ y por lo tanto es una constante que podemos agrupar con la constante de integración.  
	$U(t,x) = t\cdot sen(t\cdot x) + c$
\end{sol}